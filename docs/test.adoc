= –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å: {service-name}
:doctype: book
:toc: left
:toclevels: 3
:sectnums:
:source-highlighter: highlightjs
:service-name: Application Processing Service
:service-id: app-processing-svc
:version: 1.2.0
:git-repo: https://gitlab.example.com/bank/{service-id}

== –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å *{service-name}* –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–∏—ë–º, –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –ø–µ—Ä–≤–∏—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞—è–≤–æ–∫ –æ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü.  
–Ø–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —è–¥—Ä–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –±–∞–Ω–∫–∞.

* **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä**: `{service-id}`
* **–í–µ—Ä—Å–∏—è**: `{version}`
* **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: {git-repo}[–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥]

== –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –≥—Ä–∞–Ω–∏—Ü—ã

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
- –ü—Ä–∏—ë–º –∑–∞—è–≤–æ–∫ —á–µ—Ä–µ–∑ REST API
- –í–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º
- –ü—É–±–ª–∏–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏—è `application.submitted` –≤ Kafka
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞—è–≤–∫–∏ –¥–æ –ø–µ—Ä–µ–¥–∞—á–∏ –≤ —Å–∫–æ—Ä–∏–Ω–≥

–ù–ï –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
- –ü—Ä–æ–≤–µ—Ä–∫—É –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–µ—Å—Å–∏—è–º–∏

== –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

=== –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

* `Application` ‚Äî –∑–∞—è–≤–∫–∞
** `id` (UUID) ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
** `clientId` (string) ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞
** `type` (enum: `INDIVIDUAL`, `LEGAL_ENTITY`)
** `status` (enum: `DRAFT`, `SUBMITTED`, `REJECTED`, `APPROVED`)
** `createdAt`, `updatedAt`

=== –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

[source,json]
----
include::{service-id}/schemas/application.json[]
----

== API

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API –æ–ø–∏—Å–∞–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAPI 3.0.

[source,yaml, subs="verbatim"]
----
include::{service-id}/openapi.yaml[]
----

> üí° –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ Swagger UI.

== –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

=== –í—Ö–æ–¥—è—â–∏–µ

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ú–µ—Ç–æ–¥ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|--------|--------|
| `/applications` | POST | Frontend (web/mobile) | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏ |

=== –ò—Å—Ö–æ–¥—è—â–∏–µ

| –ö–∞–Ω–∞–ª | –¢–∏–ø | –ü–æ–ª—É—á–∞—Ç–µ–ª—å | –°–æ–±—ã—Ç–∏–µ |
|------|-----|-----------|--------|
| Kafka | async | `scoring-service` | `application.submitted` |
| Kafka | async | `notification-service` | `application.received` |

== –î–∏–∞–≥—Ä–∞–º–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

[plantuml, {service-id}-sequence, png]
----
@startuml
actor "–ö–ª–∏–µ–Ω—Ç" as Client
participant "Frontend" as FE
participant "{service-name}" as AppSvc
participant "Kafka" as Kafka
participant "Scoring Service" as Scoring

Client -> FE: –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É
FE -> AppSvc: POST /applications
activate AppSvc
AppSvc -> AppSvc: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
AppSvc --> Kafka: publish(application.submitted)
AppSvc --> FE: 201 Created + Location
deactivate AppSvc

Kafka -> Scoring: consume(application.submitted)
Scoring -> Scoring: –ó–∞–ø—É—Å–∫ —Å–∫–æ—Ä–∏–Ω–≥–∞
@enduml
----

== –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- –í—ã–±—Ä–∞–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –æ–±–º–µ–Ω —á–µ—Ä–µ–∑ Kafka –¥–ª—è –¥–µ–∫—É–ø–ª–∏–Ω–≥–∞ –æ—Ç —Å–∫–æ—Ä–∏–Ω–≥–∞.
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π POST —Å —Ç–µ–º –∂–µ `clientId` –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª—å).
- –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–¥ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è GDPR.

== –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- ADR: <<adr-001-idempotency.adoc#, –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏>>
- Runbook: <<runbook-{service-id}.adoc#, –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏>>
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: Grafana dashboard `{service-id}-prod`
